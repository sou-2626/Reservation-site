<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>アカウント設定</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    h1 { text-align: center; }
    .section { margin-top: 30px; }
    label, input { display: block; margin: 5px 0; }
    input { padding: 5px; width: 250px; }
    button { margin-top: 10px; padding: 8px 12px; }
  </style>
</head>
<body>
  <h1>アカウント設定</h1>

  <div class="section">
    <h2>一般ユーザー情報の変更</h2>
    <label for="user-id">ユーザーID:</label>
    <input type="text" id="user-id">
    <label for="user-pass">ユーザーパスワード:</label>
    <input type="password" id="user-pass">
    <button onclick="updateAccount('user')">保存</button>
  </div>

  <div class="section">
    <h2>管理者情報の変更</h2>
    <label for="admin-id">管理者ID:</label>
    <input type="text" id="admin-id">
    <label for="admin-pass">管理者パスワード:</label>
    <input type="password" id="admin-pass">
    <button onclick="updateAccount('admin')">保存</button>
  </div>

  <div class="section">
    <button onclick="goBack()">管理画面に戻る</button>
  </div>

  <script>
    if (sessionStorage.getItem("isAdminLoggedIn") !== "true") {
      window.location.href = "admin_login.html";
    }

    function getDatabase() {
      const data = localStorage.getItem("calendarData");
      return data ? JSON.parse(data) : {
        blockedDates: [],
        reservations: [],
        accounts: {
          user: { id: "user", pass: "userpass" },
          admin: { id: "admin", pass: "adminpass" }
        }
      };
    }

    function saveDatabase(db) {
      localStorage.setItem("calendarData", JSON.stringify(db));
    }

    function updateAccount(type) {
      const db = getDatabase();
      const id = document.getElementById(type + '-id').value;
      const pass = document.getElementById(type + '-pass').value;

      if (!db.accounts) db.accounts = { user: {}, admin: {} };

      if (id) db.accounts[type].id = id;
      if (pass) db.accounts[type].pass = pass;

      saveDatabase(db);
      alert((type === 'admin' ? '管理者' : 'ユーザー') + '情報を更新しました');
    }

    function goBack() {
      window.location.href = "admin_dashboard.html";
    }
  </script>
</body>
</html>